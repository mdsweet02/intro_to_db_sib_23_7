USE Фонотека;
GO

CREATE VIEW dbo.Отчёт_ПоКатегориям
AS
SELECT 
    К.Наименование AS [Категория],
    COUNT(Д.КодДиска) AS [Количество дисков],
    AVG(Д.ЦенаЗалоговая) AS [Средняя залоговая цена],
    SUM(Д.НаличиеЭкземпляров) AS [Всего в наличии]
FROM 
    КатегорииДисков К
JOIN 
    Диск Д ON К.КодКатегорииДиска = Д.КодКатегорииДиска
GROUP BY 
    К.Наименование;
GO
